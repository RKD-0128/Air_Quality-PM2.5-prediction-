# -*- coding: utf-8 -*-
"""Data_Analysis.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VThfYxr4n0Xw0nXCBM0uprjOI2dYwtyj

# Real-Time Data Analysis
"""

import requests
city = 'Ahmedabad'
url = 'http://api.waqi.info/feed/' + city + '/?token='
api_key = '835351db22b35af3e7aa10b489a72fdf56685580'
main_url = url + api_key
r = requests.get(main_url)
data = r.json()['data']
data

aqi = data['aqi']
iaqi = data['iaqi']

del iaqi['p']
iaqi
for i in iaqi.items():
  print(i[0],':',i[1]['v'])

import matplotlib.pyplot as plt

pollutants = [i for i in iaqi]
values = [i['v'] for i in iaqi.values()]

explode = [0 for i in pollutants]
mx = values.index(max(values))      #explode 1st slice
explode[mx] = 0.1

#plot 
plt.figure(figsize=(8,6))
plt.pie(values,labels= pollutants, explode = explode, autopct='%1.1f%%', shadow = True)

plt.title('air pollutant and their probable amount in atmosphere (Ahmedabad)')

plt.axis('equal')
plt.show()

"""# Historical Data analysis"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd

csv_path = '/content/drive/MyDrive/maninagar,-ahmedabad-air-quality.csv'

df = pd.read_csv(csv_path)

df

df = df.rename(columns = {' pm25' : 'pm2.5',
                          ' pm10' : 'pm10',
                          ' o3' : 'o3',
                          ' no2' : 'no2',
                          ' so2' : 'so2',
                          ' co' : 'co'})
df.columns

df['date'] = pd.to_datetime(df.date)

df21 = df.loc[df['date'] > '2019-01-01']
df21 = df21.sort_values(by='date')
df21

df21.replace(' ', '0', inplace=True)
df21

import matplotlib.pyplot as plt

dates = df21['date']
pm25 = df21['pm2.5']
pm25 = [int(i) for i in pm25]

plt.figure(figsize=(10,8))

length = len(dates)

plt.plot(dates,pm25, color='red')
plt.show()